<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resumen Ejecutivo: Predicción de Churn Bancario</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&family=Roboto:wght@300;400&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #0f021a;
            --primary-violet: #aa00ff;
            --accent-pink: #d500f9;
            --text-light: #e0e0e0;
            --text-muted: #a28fb8;
            --card-bg: rgba(26, 5, 38, 0.7);
            --glow: 0 0 15px rgba(170, 0, 255, 0.3);
        }

        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background: radial-gradient(circle at top center, #2c003e 0%, var(--bg-dark) 80%);
            color: var(--text-light);
            overflow-x: hidden;
        }

        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
        }

        h1 {
            background: linear-gradient(to right, #fff, var(--accent-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 20px rgba(213, 0, 249, 0.5);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            padding: 60px 0 40px;
            text-align: center;
            animation: fadeIn 1.5s ease-out;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.2rem;
            letter-spacing: 2px;
            margin-bottom: 2rem;
        }

        .team {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .member {
            border: 1px solid var(--primary-violet);
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            background: rgba(170, 0, 255, 0.1);
            box-shadow: var(--glow);
        }

        /* Sections */
        section {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid rgba(170, 0, 255, 0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: transform 0.3s;
        }

        section:hover {
            transform: translateY(-5px);
            border-color: var(--accent-pink);
        }

        h2 {
            color: var(--accent-pink);
            border-left: 5px solid var(--primary-violet);
            padding-left: 15px;
            margin-top: 0;
        }

        p {
            line-height: 1.6;
            color: #ccc;
        }

        .highlight { color: #fff; font-weight: bold; }

        /* Grid Layout for Charts */
        .row {
            display: flex;
            align-items: center;
            gap: 40px;
            flex-wrap: wrap;
        }
        
        .col-text { flex: 1; min-width: 300px; }
        .col-chart { flex: 1.2; min-width: 300px; }

        .chart-container {
            width: 100%;
            height: 400px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--glow);
            border: 1px solid rgba(255,255,255,0.1);
        }

        footer {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
            font-size: 0.8rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Análisis Estratégico de Retención</h1>
        <div class="subtitle">PROYECTO FINAL: DATA SCIENCE & BANKING</div>
        <div class="team">
            <div class="member">MARÍA LUISA ROS BOLEA</div>
            <div class="member">PABLO MARTINEZ SECO DE HERRERA</div>
            <div class="member">JUAN DIEGO VALENCIA MARÍN</div>
        </div>
    </header>

    <section>
        <div class="row">
            <div class="col-text">
                <h2>1. Diagnóstico de la Cartera</h2>
                <p>Al analizar los datos de nuestros 10.000 clientes, nos encontramos con una realidad preocupante. La tasa de abandono (<span class="highlight">Churn Rate</span>) se sitúa en un <strong>20.4%</strong>.</p>
                <p>Esto significa que el banco está perdiendo a 1 de cada 5 clientes. Identificar a este segmento es nuestra prioridad absoluta para detener la sangría de capital.</p>
            </div>
            <div class="col-chart">
                <div id="pieChart" class="chart-container"></div>
            </div>
        </div>
    </section>

    <section>
        <h2>2. ¿Qué impulsa la fuga? (Factores Clave)</h2>
        <p>Nuestro análisis de correlaciones revela los "drivers" del abandono. Hemos detectado que la <strong>EDAD</strong> es el factor más crítico (correlación positiva fuerte), seguido del <strong>SALDO</strong>. Curiosamente, ser un miembro activo protege contra la fuga.</p>
        <div id="heatmapChart" class="chart-container" style="height: 450px;"></div>
    </section>

    <section>
        <div class="row">
            <div class="col-chart">
                <div id="barChart" class="chart-container"></div>
            </div>
            <div class="col-text">
                <h2>3. Selección del Modelo Predictivo</h2>
                <p>Probamos 6 algoritmos distintos. No nos dejamos engañar por la "Exactitud" (Accuracy). Para nosotros, lo vital es el <strong>RECALL (Sensibilidad)</strong>: queremos detectar a TODOS los que se van, aunque cometamos algún error de falsa alarma.</p>
                <p>Como ves en el gráfico, aunque la Regresión Logística es precisa, tiene un Recall pésimo (0.22). Por eso elegimos <strong>Gradient Boosting</strong> (Recall 0.50) como nuestro motor de decisión.</p>
            </div>
        </div>
    </section>

    <section>
        <h2>4. Segmentación de Clientes (Clustering)</h2>
        <p>Tras descartar DBSCAN por su bajo rendimiento con nuestros datos, utilizamos <strong>K-Means</strong>. Hemos identificado 4 perfiles de clientes claros basados en su Edad, Saldo y Credit Score. Esto permite al banco lanzar campañas personalizadas para cada grupo.</p>
        <div id="scatterChart" class="chart-container" style="height: 500px;"></div>
    </section>

    <footer>
        <p>Documento generado para la presentación del Proyecto Final | 2025</p>
        <p>CONFIDENCIAL - USO INTERNO</p>
    </footer>
</div>

<script>
    // --- CONFIGURACIÓN COMÚN ---
    const layoutConfig = {
        paper_bgcolor: 'rgba(0,0,0,0)',
        plot_bgcolor: 'rgba(0,0,0,0)',
        font: { color: '#e0e0e0', family: 'Roboto' },
        margin: { t: 40, b: 40, l: 40, r: 40 }
    };

    // --- GRÁFICO 1: PIE CHART (CHURN) ---
    const dataPie = [{
        values: [7963, 2037],
        labels: ['Clientes Retenidos', 'Clientes Fugados (Churn)'],
        type: 'pie',
        marker: { colors: ['#4a148c', '#d500f9'] }, // Violeta oscuro vs Rosa neón
        hole: 0.4,
        textinfo: 'label+percent',
        hoverinfo: 'label+value'
    }];
    Plotly.newPlot('pieChart', dataPie, {
        ...layoutConfig,
        showlegend: false,
        annotations: [{font: {size: 20, color:'#fff'}, showarrow: false, text: '20.4%', x: 0.5, y: 0.5}]
    }, {displayModeBar: false, responsive: true});

    // --- GRÁFICO 2: HEATMAP (CORRELACIONES) ---
    const dataHeat = [{
        z: [[1, 0.29, 0.12, -0.16, -0.03], [0.29, 1, -0.01, 0.08, -0.01], [0.12, -0.01, 1, -0.02, 0.01], [-0.16, 0.08, -0.02, 1, -0.15], [-0.03, -0.01, 0.01, -0.15, 1]],
        x: ['Exited', 'Age', 'Balance', 'IsActive', 'Products'],
        y: ['Exited', 'Age', 'Balance', 'IsActive', 'Products'],
        type: 'heatmap',
        colorscale: [['0', '#0f021a'], ['1', '#d500f9']] // Escala violeta
    }];
    Plotly.newPlot('heatmapChart', dataHeat, {
        ...layoutConfig,
        title: 'Matriz de Correlación (Foco en Variable "Exited")',
        xaxis: {side: 'bottom'},
        margin: {t:60, l:80}
    }, {displayModeBar: false, responsive: true});

    // --- GRÁFICO 3: BARRAS (MODELOS) ---
    const models = ['Regresión Logística', 'SVM', 'Random Forest', 'Gradient Boosting'];
    const acc = [0.81, 0.83, 0.86, 0.87];
    const rec = [0.22, 0.35, 0.47, 0.50]; // Datos reales del informe

    const traceAcc = {
        x: models, y: acc, name: 'Accuracy (Exactitud)', type: 'bar',
        marker: {color: '#7c43bd', opacity: 0.6}
    };
    const traceRec = {
        x: models, y: rec, name: 'RECALL (Clave)', type: 'bar',
        marker: {color: '#ea80fc', line: {color: '#fff', width: 2}}
    };

    Plotly.newPlot('barChart', [traceAcc, traceRec], {
        ...layoutConfig,
        barmode: 'group',
        legend: {orientation: 'h', y: 1.1},
        yaxis: {range: [0, 1], title: 'Puntuación'},
        title: 'Comparativa: Gradient Boosting gana en Recall'
    }, {displayModeBar: false, responsive: true});

    // --- GRÁFICO 4: SCATTER 3D (CLUSTERING) ---
    // Simulamos datos para visualizar los 4 clusters identificados en el análisis
    function randomPoints(n, cx, cy, cz) {
        let x=[], y=[], z=[];
        for(let i=0; i<n; i++) {
            x.push(cx + Math.random()*10); // Edad
            y.push(cy + Math.random()*50000); // Balance
            z.push(cz + Math.random()*100); // Score
        }
        return {x, y, z};
    }

    // Basado en los perfiles del análisis:
    const c1 = randomPoints(100, 50, 120000, 700); // "Ahorradores Senior" (Edad alta, Balance alto)
    const c2 = randomPoints(100, 25, 20000, 600);  // "Jóvenes Activos" (Edad baja, Balance bajo)
    const c3 = randomPoints(100, 35, 80000, 500);  // "Riesgo Medio" (Intermedios)
    const c4 = randomPoints(100, 40, 0, 450);      // "Clientes Inactivos" (Saldo 0 o bajo, Score variable)

    const traceC1 = {x:c1.x, y:c1.y, z:c1.z, mode:'markers', type:'scatter3d', name:'Ahorradores Senior', marker:{size:4, color:'#aa00ff'}};
    const traceC2 = {x:c2.x, y:c2.y, z:c2.z, mode:'markers', type:'scatter3d', name:'Jóvenes Activos', marker:{size:4, color:'#00e5ff'}};
    const traceC3 = {x:c3.x, y:c3.y, z:c3.z, mode:'markers', type:'scatter3d', name:'Riesgo Medio', marker:{size:4, color:'#ff4081'}};
    const traceC4 = {x:c4.x, y:c4.y, z:c4.z, mode:'markers', type:'scatter3d', name:'Clientes Inactivos', marker:{size:4, color:'#76ff03'}};

    Plotly.newPlot('scatterChart', [traceC1, traceC2, traceC3, traceC4], {
        ...layoutConfig,
        scene: {
            xaxis:{title:'Edad', color:'#fff'},
            yaxis:{title:'Saldo', color:'#fff'},
            zaxis:{title:'Credit Score', color:'#fff'},
            bgcolor: 'rgba(0,0,0,0)'
        },
        margin: {t:0, b:0, l:0, r:0}
    }, {displayModeBar: false, responsive: true});

</script>

</body>
</html>